@echo off
chcp 65001 >nul
title GameStream Hub - Auto Launcher
echo.
echo ========================================
echo    GameStream Hub - Auto Launcher
echo ========================================
echo.

:: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Node.js
echo [1/4] ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Node.js...
node --version >nul 2>&1
if %errorlevel% neq 0 (
    echo ERROR: Node.js Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½!
    echo Ð¡ÐºÐ°Ñ‡Ð°Ð¹Ñ‚Ðµ Ñ https://nodejs.org/
    pause
    exit /b 1
)
echo âœ“ Node.js ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½

:: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ ÑÐµÑ€Ð²ÐµÑ€Ð°
echo [2/4] ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ ÑÐµÑ€Ð²ÐµÑ€Ð°...
if not exist "server\node_modules" (
    echo Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ ÑÐµÑ€Ð²ÐµÑ€Ð°...
    cd server
    npm install
    cd ..
) else (
    echo âœ“ Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ ÑÐµÑ€Ð²ÐµÑ€Ð° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹
)

:: Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð°
echo [3/4] Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð°...
start "GameStream Server" cmd /k "cd server && npm start"

:: ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð°
echo ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð° (5 ÑÐµÐº)...
timeout /t 5 /nobreak >nul

:: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ IP Ð°Ð´Ñ€ÐµÑÐ°
echo [4/4] ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ÑÐµÑ‚ÐµÐ²Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸...
for /f "tokens=2 delims=:" %%i in ('ipconfig ^| findstr "IPv4"') do (
    set IP=%%i
    goto :ip_found
)
:ip_found
set IP=%IP:~1%
echo.

echo ========================================
echo          Ð¡Ð¡Ð«Ð›ÐšÐ˜ Ð”Ð›Ð¯ ÐŸÐžÐ”ÐšÐ›Ð®Ð§Ð•ÐÐ˜Ð¯
echo ========================================
echo.
echo ðŸ“ ÐÐ° ÑÑ‚Ð¾Ð¼ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ðµ:
echo    http://localhost:3000
echo.
echo ðŸŒ ÐÐ° Ð´Ñ€ÑƒÐ³Ð¸Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… Ð² ÑÐµÑ‚Ð¸:
echo    http://%IP%:3000
echo.
echo ðŸ“± ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ ÑÑ‚Ñƒ ÑÑÑ‹Ð»ÐºÑƒ Ð´Ñ€ÑƒÐ³Ñƒ:
echo    http://%IP%:3000
echo.
echo ========================================
echo.

:: ÐžÑ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°
start "" "http://localhost:3000"

echo Ð‘Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸...
echo ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð»ÑŽÐ±ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ Ð´Ð»Ñ Ð²Ñ‹Ñ…Ð¾Ð´Ð°...
pause >nul